{% extends 'layout.html.twig' %}

{% block content_title %}
    Manage all your sensors here
{% endblock %}
{% block content %}
    <div class="jumbotron">
        <a class="btn btn-primary" href="{{ path(route ~ '_add') }}">Add new Sensor</a>
        <br>
        <table class="table table-stripped">
            <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Name</th>
                <th scope="col">UUID</th>
                <th scope="col">Room</th>
                <th scope="col">Floor</th>
                <th scope="col">Switchable</th>
                <th scope="col">Adjustable</th>
                <th scope="col">Created at</th>
                <th scope="col">IP</th>
                <th scope="col">Value</th>
                <th scope="col">Active</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for key, entity in entities %}
                <tr id="sensor" data-uuid="{{ entity.uuid }}">
                    <td>{{ entity.id }}</td>
                    <td>{{ entity.name }}</td>
                    <td>{{ entity.uuid }}</td>
                    <td>{% if entity.room is null %} No room set. Set by yourself. {% else %}{{ entity.room.room }}{% endif %}</td>
                    <td>{% if entity.room is null %} No floor set. Set by yourself. {% else %}{{ entity.room.floor }}{% endif %}</td>
                    <td>{{ entity.switchable | boolToInt }}</td>
                    <td>{{ entity.adjustable | boolToInt }}</td>
                    <td>{{ entity.createdAt | date('Y-m-d H:i:s') }}</td>
                    <td>{{ entity.sensorIp }}</td>
                    <td>{{ entity.status }}</td>
                    {% set status = entity.active | inversedBoolToInt %}
                    <td>{{ entity.active | boolToInt }}</td>
                    <td>
                        {% if entity.switchable == true and entity.adjustable == false %}
                            <a class="btn btn-info"
                               href="{{ path('sensor_set_status', {'uuid' : entity.uuid, 'status' : status }) }}">Turn {{ status | onOffBoolean }}</a>
                        {% elseif entity.switchable == true and entity.adjustable == true %}
                            <label for="sensorStatusSet-{{ entity.uuid }}">Value:</label>
                            <input type="range" step="1" min="{{ entity.minimumValue }}" max="{{ entity.maximumValue }}"
                                   value="{{ entity.status }}" class="sensorStatusSet" id="sensorStatusSet-{{ entity.uuid }}">
                            <output for="sensorStatusSet-{{ entity.uuid }}" class="sensorStatusOutput" id="sensorStatusOutput-{{ entity.uuid }}">{{ entity.status }}</output>
                            {% if entity.status != 0 %}
                                <a class="btn btn-info"
                                   href="{{ path('sensor_set_status', {'uuid' : entity.uuid, 'status' : 0 }) }}">Turn off</a>
                            {% endif %}
                        {% endif %}
                        <a class="btn btn-info" href="{{ path(route ~ '_edit', {'id' : entity.id}) }}">Edit</a>
                        <a class="btn btn-danger" href="{{ path(route ~ '_delete', {'id' : entity.id}) }}">Delete</a>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}