version: "2"
services:
    code:
        container_name: code.imperius.home
        build: ./docker/code
        networks:
            - imperius
        volumes:
            - .:/code

    web:
        container_name: web.imperius.home
        build: ./docker/nginx
        networks:
            - imperius
        ports:
            - 8090:80
        volumes_from:
            - code

    php-fpm:
        container_name: php-fpm.imperius.home
        build: ./docker/php-fpm
        networks:
            - imperius
        volumes_from:
            - code
        expose:
          - 9000
          - 9001

    mysql:
        container_name: mysql.imperius.home
        build: ./docker/mysql
        networks:
            - imperius
        volumes:
            - ../imperius-mysql:/var/lib/mysql
        ports:
            - 13333:3306
        environment:
            - MYSQL_DATABASE=imperius
            - MYSQL_USER=imperius-project
            - MYSQL_PASSWORD=imperius-project-pass
            - MYSQL_ROOT_PASSWORD=root

volumes:
    imperius:
        external: true
    imperius-mysql:
        external: true

networks:
    imperius:
        external: true
